<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Microsoft Python Programming Interview Question | JoeLogs</title>
<meta name=keywords content="python"><meta name=description content="I want to discuss an interview question that was asked in an interview at Microsoft during my interview for the poistion of a Research Fellow( RF ). The question primary deals with python programming knowledge and it requires understanding of generators. In this post I will discuss the programming topics that are required to solve the question and finally give a solutioin to the question. The question is pretty open ended and I was asked to write the code in a google doc."><meta name=author content="Sathvik Joel"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.f9589a61e1bfb8dc772aa8afbcf34ad46fa01c2148078d70b4d0907374e82745.css integrity="sha256-+ViaYeG/uNx3KqivvPNK1G+gHCFIB41wtNCQc3ToJ0U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/tech/12042024_msft_interview/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]},chtml:{scale:1.2},svg:{scale:1.2}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel=stylesheet><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel=stylesheet><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Microsoft Python Programming Interview Question"><meta property="og:description" content="I want to discuss an interview question that was asked in an interview at Microsoft during my interview for the poistion of a Research Fellow( RF ). The question primary deals with python programming knowledge and it requires understanding of generators. In this post I will discuss the programming topics that are required to solve the question and finally give a solutioin to the question. The question is pretty open ended and I was asked to write the code in a google doc."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/tech/12042024_msft_interview/"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-10T11:30:03+00:00"><meta property="article:modified_time" content="2024-04-10T11:30:03+00:00"><meta property="og:site_name" content="JoeLogs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Microsoft Python Programming Interview Question"><meta name=twitter:description content="I want to discuss an interview question that was asked in an interview at Microsoft during my interview for the poistion of a Research Fellow( RF ). The question primary deals with python programming knowledge and it requires understanding of generators. In this post I will discuss the programming topics that are required to solve the question and finally give a solutioin to the question. The question is pretty open ended and I was asked to write the code in a google doc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Postsüìö","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Techüë®‚Äçüíª","item":"http://localhost:1313/posts/tech/"},{"@type":"ListItem","position":3,"name":"Microsoft Python Programming Interview Question","item":"http://localhost:1313/posts/tech/12042024_msft_interview/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Microsoft Python Programming Interview Question","name":"Microsoft Python Programming Interview Question","description":"I want to discuss an interview question that was asked in an interview at Microsoft during my interview for the poistion of a Research Fellow( RF ). The question primary deals with python programming knowledge and it requires understanding of generators. In this post I will discuss the programming topics that are required to solve the question and finally give a solutioin to the question. The question is pretty open ended and I was asked to write the code in a google doc.","keywords":["python"],"articleBody":"I want to discuss an interview question that was asked in an interview at Microsoft during my interview for the poistion of a Research Fellow( RF ). The question primary deals with python programming knowledge and it requires understanding of generators. In this post I will discuss the programming topics that are required to solve the question and finally give a solutioin to the question. The question is pretty open ended and I was asked to write the code in a google doc. So, feel free to write your own solution.\nThe Question ü§î You are given a dataset that is a list of sample, label. For example: $$ \\begin{align*} \\text{data} = { (X_1, y_1), (X_2, y_2), \\ldots, (X_n, y_n) } \\end{align*} $$\nYou are required to write a function that takes this dataset and returns batches of data. But ofcourse, we dont need all the batches at once. We need to generate the batches on the fly. This is where the concept of generators comes into play.\nFunction Definition üìù The function definition is as follows:\ndef batch_generator(data, batch_size): ``` Args: data: list of tuples batch_size: int Returns: Generator that returns batches of data Batch should be a pair of samples and lables Eg: (X_batch, y_batch) where X_batch and y_batch are lists ``` pass Generators üßê To understand Generators we need to understand the concept of iterables and iterators.\nIterables: An iterable is an object that can be iterated upon, simply we can use a for loop to iterate over it.\nIt must implement the __iter__ method and the __iter__ method must return an iterator.\nIterators: An Object with a state and rememebers where it is during the iteration and knows how to get the next value.\nIt must implement the __next__ method and the __iter__ method, this is called Iterator Protocol.\nGenerators: A generator is a special type of iterator that generates values on the fly. More precisely, generator functions are a special kind of function that returns a lazy iterator.\nHow does generator work? A generator function is very similar to a regular function, but instead of a return statement, a generator uses yield statement.\nSo, whats the difference between return and yield?\nWhen the Python yield statement is hit, the program suspends function execution and returns the yielded value to the caller. (In contrast, return stops function execution completely.) When a function is suspended, the state of that function is saved. This includes any variable bindings local to the generator, the instruction pointer, the internal stack, and any exception handling. So when the function is called again, the function resumes execution right after the yield statement1\nTo understand this better, lets look at an example that is taken from the Real Python Blog1.\ndef multi_yield(): yield_str = \"This will print the first string\" yield yield_str yield_str = \"This will print the second string\" yield yield_str multi_obj = multi_yield() print(next(multi_obj)) print(next(multi_obj)) print(next(multi_obj)) This will print the first string This will print the second string Traceback (most recent call last): File \"\", line 1, in StopIteration It can be seen that the second time the next is called, the function resumes execution right after the first yield statement.\nSince the generator returns an interator, it already implements the __iter__ and __next__ methods. So, we can use the generator in a for loop.\nConstraints üìè The function should return batches of data. For the last batch return a batch that is same size as the batch size; use None for the sample and label if the batch is smaller than the batch size. Solution üß† def batch_generator(data, batch_size): for i in range(0, len(data), batch_size): X_batch = [] y_batch = [] for j in range(i, i+batch_size): if j \u003e= len(data): X_batch.append(None) y_batch.append(None) else: X_batch.append(data[j][0]) y_batch.append(data[j][1]) yield X_batch, y_batch Extension üöÄ Obviously, this is not the only question the interviewer asked me, later he asked me to extend this function. The interviewr could have asked an extention in a number of ways for example:\nConvert it into a class Add a method to shuffle the data Add a collate function to collate the data But due the limitation of time, the interviwer asked me a simple extention to this, the extention was the following:\nAssume $X_1, X_2, \\ldots, X_n$ are sentences and the task is to convert these sentences into tokens before returning the batch. Also, there is a variable seq_len that is the maximum length of the tokens in the returned batch and it is the job of the batching function to turncate or elonate the sentences to make them of length seq_len.\nHere I assumed that there is a tokenizer object, and the following were defined:\ntokenizer.tokenize(sentence): This function tokenizes the sentence and returns a list of tokens. tokenizer.pad_index : This is the index of the padding token in the vocabulary. This is pretty easy to integrate into the existing function. So I shall leave this as an exercise.\nReal Python Blog on Generators¬†‚Ü©Ô∏é¬†‚Ü©Ô∏é\n","wordCount":"826","inLanguage":"en","datePublished":"2024-04-10T11:30:03Z","dateModified":"2024-04-10T11:30:03Z","author":{"@type":"Person","name":"Sathvik Joel"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/tech/12042024_msft_interview/"},"publisher":{"@type":"Organization","name":"JoeLogs","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Joe'Logs (Alt + H)">Joe'Logs</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title="Searchüîç (Alt + /)" accesskey=/><span>Searchüîç</span></a></li><li><a href=http://localhost:1313/posts/ title=Postsüìö><span>Postsüìö</span></a></li><li><a href=http://localhost:1313/archives/ title=Archives‚è±Ô∏è><span>Archives‚è±Ô∏è</span></a></li><li><a href=http://localhost:1313/tags/ title=Tagsüè∑Ô∏è><span>Tagsüè∑Ô∏è</span></a></li><li><a href=http://localhost:1313/posts/life title=Lifeüå±><span>Lifeüå±</span></a></li><li><a href=http://localhost:1313/posts/tech title=Techüë®‚Äçüíª><span>Techüë®‚Äçüíª</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;¬ª&nbsp;<a href=http://localhost:1313/posts/>Postsüìö</a>&nbsp;¬ª&nbsp;<a href=http://localhost:1313/posts/tech/>Techüë®‚Äçüíª</a></div><h1 class=post-title>Microsoft Python Programming Interview Question</h1><div class=post-meta>&lt;span title='2024-04-10 11:30:03 +0000 UTC'>April 10, 2024&lt;/span>&amp;nbsp;¬∑&amp;nbsp;4 min&amp;nbsp;¬∑&amp;nbsp;Sathvik Joel</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#the-question- aria-label="The Question ü§î">The Question ü§î</a><ul><li><a href=#function-definition- aria-label="Function Definition üìù">Function Definition üìù</a></li></ul></li><li><a href=#generators- aria-label="Generators üßê">Generators üßê</a><ul><li><a href=#how-does-generator-work aria-label="How does generator work?">How does generator work?</a></li></ul></li><li><a href=#constraints- aria-label="Constraints üìè">Constraints üìè</a></li><li><a href=#solution- aria-label="Solution üß†">Solution üß†</a></li><li><a href=#extension- aria-label="Extension üöÄ">Extension üöÄ</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>I want to discuss an interview question that was asked in an interview at Microsoft during my interview for the poistion of a Research Fellow( RF ). The question primary deals with python programming knowledge and it requires understanding of <strong>generators</strong>. In this post I will discuss the programming topics that are required to solve the question and finally give a solutioin to the question. The question is pretty open ended and I was asked to write the code in a google doc. So, feel free to write your own solution.</p><h2 id=the-question->The Question ü§î<a hidden class=anchor aria-hidden=true href=#the-question->#</a></h2><p>You are given a dataset that is a list of sample, label.
For example:
$$
\begin{align*}
\text{data} = { (X_1, y_1), (X_2, y_2), \ldots, (X_n, y_n) }
\end{align*}
$$</p><p>You are required to write a function that takes this dataset and returns batches of data. But ofcourse, we dont need all the batches at once. We need to generate the batches on the fly. This is where the concept of <strong>generators</strong> comes into play.</p><h3 id=function-definition->Function Definition üìù<a hidden class=anchor aria-hidden=true href=#function-definition->#</a></h3><p>The function definition is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>batch_generator</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=err>```</span>
</span></span><span class=line><span class=cl>    <span class=n>Args</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>:</span> <span class=nb>list</span> <span class=n>of</span> <span class=n>tuples</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>Returns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>Generator</span> <span class=n>that</span> <span class=n>returns</span> <span class=n>batches</span> <span class=n>of</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        <span class=n>Batch</span> <span class=n>should</span> <span class=n>be</span> <span class=n>a</span> <span class=n>pair</span> <span class=n>of</span> <span class=n>samples</span> <span class=ow>and</span> <span class=n>lables</span>
</span></span><span class=line><span class=cl>        <span class=n>Eg</span><span class=p>:</span> <span class=p>(</span><span class=n>X_batch</span><span class=p>,</span> <span class=n>y_batch</span><span class=p>)</span> <span class=n>where</span> <span class=n>X_batch</span> <span class=ow>and</span> <span class=n>y_batch</span> <span class=n>are</span> <span class=n>lists</span>
</span></span><span class=line><span class=cl>    <span class=err>```</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></div><h2 id=generators->Generators üßê<a hidden class=anchor aria-hidden=true href=#generators->#</a></h2><p>To understand Generators we need to understand the concept of <strong>iterables</strong> and <strong>iterators</strong>.</p><blockquote><p><strong>Iterables</strong>: An iterable is an object that can be iterated upon, simply we can use a for loop to iterate over it.</p></blockquote><p>It must implement the <code>__iter__</code> method and the <code>__iter__</code> method must return an iterator.</p><blockquote><p><strong>Iterators</strong>: An Object with a state and rememebers where it is during the iteration and knows how to get the next value.</p></blockquote><p>It must implement the <code>__next__</code> method and the <code>__iter__</code> method, this is called <a href=https://realpython.com/python-iterators-iterables#what-is-the-python-iterator-protocol>Iterator Protocol</a>.</p><blockquote><p><strong>Generators</strong>: A generator is a special type of iterator that generates values on the fly. More precisely, generator functions are a special kind of function that <strong>returns</strong> a lazy iterator.</p></blockquote><h3 id=how-does-generator-work>How does generator work?<a hidden class=anchor aria-hidden=true href=#how-does-generator-work>#</a></h3><p>A generator function is very similar to a regular function, but instead of a <code>return</code> statement, a generator uses <code>yield</code> statement.</p><p>So, whats the difference between <code>return</code> and <code>yield</code>?</p><p>When the Python yield statement is hit, the program suspends function execution and returns the yielded value to the caller. (In contrast, return stops function execution completely.) When a function is suspended, the state of that function is saved. This includes any variable bindings local to the generator, the instruction pointer, the internal stack, and any exception handling. <em>So when the function is called again, the function resumes execution right after the yield statement</em><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p>To understand this better, lets look at an example that is taken from the Real Python Blog<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>multi_yield</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>yield_str</span> <span class=o>=</span> <span class=s2>&#34;This will print the first string&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>yield</span> <span class=n>yield_str</span>
</span></span><span class=line><span class=cl>    <span class=n>yield_str</span> <span class=o>=</span> <span class=s2>&#34;This will print the second string&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>yield</span> <span class=n>yield_str</span>
</span></span><span class=line><span class=cl><span class=n>multi_obj</span> <span class=o>=</span> <span class=n>multi_yield</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>next</span><span class=p>(</span><span class=n>multi_obj</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>next</span><span class=p>(</span><span class=n>multi_obj</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>next</span><span class=p>(</span><span class=n>multi_obj</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>This will print the first string
This will print the second string

Traceback (most recent call last):
File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
StopIteration
</code></pre><p>It can be seen that the second time the next is called, the function resumes execution right after the first yield statement.</p><p>Since the generator returns an interator, it already implements the <code>__iter__</code> and <code>__next__</code> methods. So, we can use the generator in a for loop.</p><h2 id=constraints->Constraints üìè<a hidden class=anchor aria-hidden=true href=#constraints->#</a></h2><ol><li>The function should return batches of data.</li><li>For the last batch return a batch that is same size as the batch size; use None for the sample and label if the batch is smaller than the batch size.</li></ol><h2 id=solution->Solution üß†<a hidden class=anchor aria-hidden=true href=#solution->#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>batch_generator</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>X_batch</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>y_batch</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>i</span><span class=o>+</span><span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>X_batch</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>y_batch</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>X_batch</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=n>y_batch</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>X_batch</span><span class=p>,</span> <span class=n>y_batch</span>
</span></span></code></pre></div><h2 id=extension->Extension üöÄ<a hidden class=anchor aria-hidden=true href=#extension->#</a></h2><p>Obviously, this is not the only question the interviewer asked me, later he asked me to extend this function. The interviewr could have asked an extention in a number of ways for example:</p><ul><li>Convert it into a class</li><li>Add a method to shuffle the data</li><li>Add a collate function to collate the data</li></ul><p>But due the limitation of time, the interviwer asked me a simple extention to this, the extention was the following:</p><p>Assume $X_1, X_2, \ldots, X_n$ are sentences and the task is to convert these sentences into tokens before returning the batch. Also, there is a variable <code>seq_len</code> that is the maximum length of the tokens in the returned batch and it is the job of the batching function to turncate or elonate the sentences to make them of length <code>seq_len</code>.</p><p>Here I assumed that there is a tokenizer object, and the following were defined:</p><ul><li><code>tokenizer.tokenize(sentence)</code>: This function tokenizes the sentence and returns a list of tokens.</li><li><code>tokenizer.pad_index</code> : This is the index of the padding token in the vocabulary.</li></ul><p>This is pretty easy to integrate into the existing function. So I shall leave this as an exercise.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://realpython.com/introduction-to-python-generators/>Real Python Blog on Generators</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/python/>Python</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/life/13042024_gyp/><span class=title>¬´ Prev</span><br><span>Best 10 months, POSCO GYP Program</span>
</a><a class=next href=http://localhost:1313/posts/tech/12032024_forest/><span class=title>Next ¬ª</span><br><span>Forest in Latex</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>JoeLogs</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>